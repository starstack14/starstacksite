const CACHE='v3',ASSETS=['/','styles.css','script.js','favicon.svg'];self.addEventListener('install',e=>{e.waitUntil(caches.open(CACHE).then(c=>c.addAll(ASSETS)).then(()=>self.skipWaiting()))});self.addEventListener('activate',e=>{e.waitUntil(caches.keys().then(k=>Promise.all(k.map(x=>x!==CACHE?caches.delete(x):void 0))).then(()=>self.clients.claim()))});self.addEventListener('fetch',e=>{const{request:r}=e;if(r.headers.get('accept')?.includes('text/html')){e.respondWith(fetch(r).then(res=>{const copy=res.clone();caches.open(CACHE).then(c=>c.put(r,copy));return res}).catch(()=>caches.match(r)||caches.match('/offline.html')))}else{e.respondWith(caches.match(r)||fetch(r).then(res=>{const copy=res.clone();caches.open(CACHE).then(c=>c.put(r,copy));return res}))}});